(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63655,       1524]
NotebookOptionsPosition[     62168,       1489]
NotebookOutlinePosition[     62651,       1507]
CellTagsIndexPosition[     62608,       1504]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<W\>\"", "\[DirectedEdge]", "\"\<\[ScriptCapitalQ]\>\""}], 
     " ", "\[Rule]", " ", 
     "\"\<qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<\[ScriptCapitalR]\>\""}], " ", "\[Rule]", 
     " ", "\"\<\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\"\
"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<\[ScriptCapitalR]\>\""}], " ", "\[Rule]", 
     " ", "\"\<\[Gamma]2\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalQ]\>\"\
"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(D\), \(W\)]\)\>\"", " ", "\[DirectedEdge]", 
      " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(D\), \(WW\)]\)\>\"", " ", "\[DirectedEdge]", 
      " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<W\>\"", " ", "\[DirectedEdge]", " ", "\"\<DeadPool\>\""}], 
     " ", "\[Rule]", " ", "\"\<\[Delta]\>\""}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.842353405858324*^9, 3.8423534111522913`*^9}, {
  3.842353443634672*^9, 3.8423535128951483`*^9}, {3.8423695782255583`*^9, 
  3.842369662646483*^9}, {3.842499018129982*^9, 3.842499028565138*^9}, {
  3.842499141257599*^9, 3.842499164650239*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"380efcab-9472-41c1-887d-de8fda890912"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", "W", 
       "\[ScriptCapitalQ]", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)", 
       "\[ScriptCapitalR]", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)", 
       "\!\(\*SubscriptBox[\(D\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(D\), \(WW\)]\)", "DeadPool"}, {{{1, 2}, {2, 3}, {
       4, 5}, {6, 5}, {7, 2}, {8, 2}, {2, 9}}, Null}, {
      EdgeLabels -> {DirectedEdge["W", "\[ScriptCapitalQ]"] -> Placed[
           Style["qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)", 
           "\[ScriptCapitalR]"] -> Placed[
           Style["\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\!\(\*SubscriptBox[\(D\), \(WW\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], DirectedEdge["W", "DeadPool"] -> Placed[
           Style["\[Delta]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", "W"] -> Placed[
           Style[
           "\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)", 
           "\[ScriptCapitalR]"] -> Placed[
           Style["\[Gamma]2\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalQ]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\!\(\*SubscriptBox[\(D\), \(W\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredEmbedding", "RootVertex" -> "W", "Orientation" -> Top, 
         "LeafDistance" -> 4}, ImageSize -> 450, PerformanceGoal -> "Quality",
        VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], DynamicLocation[
            "VertexID$2", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$1"], InsetBox[
          
          StyleBox["\<\"\\!\\(\\*FractionBox[\\(\[Beta]\[ThinSpace]\[Cross]\
\[ThinSpace]\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\
\\), \\(\[ScriptCapitalN] - \[ScriptCapitalQ][t]\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$1", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], DynamicLocation[
            "VertexID$3", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$2"], InsetBox[
          
          StyleBox["\<\"qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"\
\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$2", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], DynamicLocation[
            "VertexID$9", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$3"], InsetBox[
          StyleBox["\<\"\[Delta]\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$3", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$4", Automatic, Center], DynamicLocation[
            "VertexID$5", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$4"], InsetBox[
          
          StyleBox["\<\"\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalI]\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$4", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$6", Automatic, Center], DynamicLocation[
            "VertexID$5", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$5"], InsetBox[
          
          StyleBox["\<\"\[Gamma]2\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalQ]\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$5", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$7", Automatic, Center], DynamicLocation[
            "VertexID$2", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$6"], InsetBox[
          StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(f\\), \\(W\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$6", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$8", Automatic, Center], DynamicLocation[
            "VertexID$2", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$7"], InsetBox[
          StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(f\\), \\(WW\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$7", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \
\\(S\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {0.3247217580466657, -1.5954565255956534}],
         "DynamicName",
         BoxID -> "VertexID$1"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"W\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {1.7173430056922485, -1.4213788696399556}],
         "DynamicName",
         BoxID -> "VertexID$2"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"\[ScriptCapitalQ]\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {2.4136536295150397, -1.5954565255956534}],
         "DynamicName",
         BoxID -> "VertexID$3"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \
\\(W\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {0.3247217580466658, -0.7719353535466238}],
         "DynamicName",
         BoxID -> "VertexID$4"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"\[ScriptCapitalR]\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {1.2191489490465817, -0.32472175804666586}],
         "DynamicName",
         BoxID -> "VertexID$5"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(WW\
\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {2.1135761400464976, -0.7719353535466238}],
         "DynamicName",
         BoxID -> "VertexID$6"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(W\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {1.021032381869457, -1.5954565255956534}],
         "DynamicName",
         BoxID -> "VertexID$7"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(D\\), \\(WW\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {1.7173430056922485, -1.5954565255956534}],
         "DynamicName",
         BoxID -> "VertexID$8"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"DeadPool\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {3.1099642533378313, -1.5954565255956534}],
         "DynamicName",
         BoxID -> "VertexID$9"]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{{3.842353174436042*^9, 3.842353196267269*^9}, {
   3.8423534311154203`*^9, 3.8423534629085693`*^9}, 3.84235351429354*^9, {
   3.842369617301797*^9, 3.8423696633561573`*^9}, {3.8424343889347353`*^9, 
   3.842434402881682*^9}, {3.84249914943582*^9, 3.842499165034878*^9}, 
   3.9096535692282352`*^9, 3.9096536060954123`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"d4749f87-8067-4712-8e28-ee9f8682c91e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalS]\>\"", " ", "\[DirectedEdge]", 
      "\"\<\[ScriptCapitalI]\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)\>\""}], ",", 
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalI]\>\"", "\[DirectedEdge]", 
      "\"\<\[ScriptCapitalQ]\>\""}], " ", "\[Rule]", " ", 
     "\"\<qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\""}], ",", 
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalI]\>\"", " ", "\[DirectedEdge]", " ", 
      "\"\<\[ScriptCapitalR]\>\""}], " ", "\[Rule]", " ", 
     "\"\<\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\""}], 
    ",", 
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalR]\>\"", "\[DirectedEdge]", 
      "\"\<\[ScriptCapitalS]\>\""}], "->", "\"\<\[Delta]\>\""}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.84235323324651*^9, 3.8423532700048857`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e8ebf195-1dbd-4ea9-aa06-86ec9f105310"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\[ScriptCapitalS]", "\[ScriptCapitalI]", "\[ScriptCapitalQ]", 
       "\[ScriptCapitalR]"}, {{{1, 2}, {2, 3}, {2, 4}, {4, 1}}, Null}, {
      EdgeLabels -> {
        DirectedEdge["\[ScriptCapitalI]", "\[ScriptCapitalQ]"] -> Placed[
           Style["qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\[ScriptCapitalR]", "\[ScriptCapitalS]"] -> Placed[
           Style["\[Delta]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\[ScriptCapitalI]", "\[ScriptCapitalR]"] -> Placed[
           Style["\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\[ScriptCapitalS]", "\[ScriptCapitalI]"] -> Placed[
           Style[
           "\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredDigraphEmbedding", "RootVertex" -> "\[ScriptCapitalS]", 
         "Orientation" -> Left}, ImageSize -> 450, PerformanceGoal -> 
       "Quality", VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]], Typeset`boxes, 
    Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[Medium], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*FractionBox[\\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\\), \\(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$1", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$3", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$2"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$2", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$3"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$3", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[
          BezierCurveBox[{
            DynamicLocation[
            "VertexID$4", Automatic, Center], {-0.2172839238223868, 
            1.0000000058221008`}, {-0.28395059048905347`, 
            1.0000000076084272`}, {-0.3555555287606583, 
            1.0000000095270742`}, {-0.4320987386372015, 
            1.0000000115780416`}, {-0.513580220118683, 
            1.0000000137613296`}, {-0.5999999732051027, 
            1.000000016076938}, {-0.6874424759218108, 
            0.9965081330807579}, {-0.7719922062941575, 
            0.9860324793286808}, {-0.8536491643221427, 
            0.9685730548207067}, {-0.9324133500057663, 
            0.9441298595568349}, {-1.0082847633450285`, 
            0.9127028935370661}, {-1.0812634043399294`, 
            0.8742921567614004}, {-1.1513492729904686`, 
            0.828897649229837}, {-1.2185423692966464`, 
            0.7765193709423768}, {-1.2828426932584627`, 
            0.7171573218990192}, {-1.3938510158370114`, 
            0.6061490052693834}, {-1.4970282940692992`, 
            0.5029717325663448}, {-1.5923745279553256`, 
            0.40762550378990325`}, {-1.679889717495091, 
            0.3201103189400588}, {-1.7595738626885948`, 0.24042617801681163`}, 
            DynamicLocation["VertexID$1", Automatic, Center]}]], 
         "DynamicName", BoxID -> "EdgeLabelID$4"], 
        InsetBox[
         FormBox[
          StyleBox["\"\[Delta]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$4", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalS]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {-1.9999999999999993`, 
         5.3589794058235685`*^-8}], "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalI]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {-0.9999999999999997, 2.6794897029117842`*^-8}],
         "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalQ]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0., 0.}], "DynamicName", BoxID -> 
        "VertexID$3"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalR]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {2.6794897029117842`*^-8, 0.9999999999999997}], 
        "DynamicName", BoxID -> "VertexID$4"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{0., 674.9999999999999}, {-187.48046446255478`, 180.}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{3.842353235150687*^9, 3.8423532707918367`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"60e8eaa8-cbf1-40aa-9842-b101b0fe0129"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<(1 - p)\!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", "\"\<p \!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<q \!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(WW\)]\)\>\""}]}], "}"}], "]"}]], "Input",\

 CellChangeTimes->{{3.8425030331323557`*^9, 3.8425030855815487`*^9}, {
  3.842503158381469*^9, 3.842503230350486*^9}, {3.84250338896522*^9, 
  3.8425034462125187`*^9}, {3.8425035707219467`*^9, 3.842503639040506*^9}, {
  3.842504437759941*^9, 3.842504698583741*^9}, {3.842504959051269*^9, 
  3.842504973852881*^9}, {3.842505058024083*^9, 3.842505090667911*^9}, {
  3.8425051811691847`*^9, 3.8425052065191307`*^9}, {3.842505850813733*^9, 
  3.842505895372611*^9}, {3.842507242311509*^9, 3.842507341095758*^9}, {
  3.843902638603745*^9, 3.843902643595065*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"ffc40bd8-6ec4-47a8-b15d-0cb56d99aae6"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)", "W"}, {{{1, 
       2}, {1, 3}, {4, 5}, {4, 6}, {5, 6}, {5, 7}, {6, 7}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)"] -> Placed[
           Style[
           "\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)"] -> Placed[
           Style[
           "\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)"] -> Placed[
           Style["(1 - p)\!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)"] -> Placed[
           Style["p \!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)", "W"] -> 
         Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)"] -> Placed[
           Style["q \!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredEmbedding", "RootVertex" -> "W", "Orientation" -> Top, 
         "LeafDistance" -> 4}, ImageSize -> 450, PerformanceGoal -> "Quality",
        VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], DynamicLocation[
            "VertexID$2", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$1"], InsetBox[
          
          StyleBox["\<\"(1 - p)\\!\\(\\*SubscriptBox[\\(\[Eta]\\), \
\\(W\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$1", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], DynamicLocation[
            "VertexID$3", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$2"], InsetBox[
          StyleBox["\<\"p \\!\\(\\*SubscriptBox[\\(\[Eta]\\), \\(W\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$2", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$4", Automatic, Center], DynamicLocation[
            "VertexID$5", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$3"], InsetBox[
          
          StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(W\\)]\\) + \
2(1-q)\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$3", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$4", Automatic, Center], DynamicLocation[
            "VertexID$6", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$4"], InsetBox[
          
          StyleBox["\<\"q \\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\
\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$4", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$5", Automatic, Center], DynamicLocation[
            "VertexID$6", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$5"], InsetBox[
          
          StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(W\\)]\\) + \
2(1-q)\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$5", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$5", Automatic, Center], DynamicLocation[
            "VertexID$7", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$6"], InsetBox[
          StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(f\\), \\(W\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$6", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}, {
         TagBox[
          ArrowBox[{
           DynamicLocation["VertexID$6", Automatic, Center], DynamicLocation[
            "VertexID$7", Automatic, Center]}],
          "DynamicName",
          BoxID -> "EdgeLabelID$7"], InsetBox[
          StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(f\\), \\(WW\\)]\\)\"\>",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->18,
           FontColor->GrayLevel[0]], 
          Offset[{0, 2}, DynamicLocation[
           "EdgeLabelID$7", Automatic, Scaled[0.5]]], ImageScaled[{0.5, 0}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \
\\(S\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {1.1606039138055106, -1.4727300308800262}],
         "DynamicName",
         BoxID -> "VertexID$1"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \
\\(W\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {0.2661767228055948, -1.919943626379984}],
         "DynamicName",
         BoxID -> "VertexID$2"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(WW\
\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {2.0550311048054266, -1.919943626379984}],
         "DynamicName",
         BoxID -> "VertexID$3"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \
\\(S\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {0.9403765852688367, -0.2661767228055948}],
         "DynamicName",
         BoxID -> "VertexID$4"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \
\\(W\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {0.2661767228055947, -0.6032766540372159}],
         "DynamicName",
         BoxID -> "VertexID$5"], 
        TagBox[InsetBox[
          FrameBox[
           
           StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(WW\
\\)]\\)\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {1.6145764477320788, -0.6032766540372159}],
         "DynamicName",
         BoxID -> "VertexID$6"], 
        TagBox[InsetBox[
          FrameBox[
           StyleBox["\<\"W\"\>",
            StripOnInput->False,
            LineColor->GrayLevel[0],
            FrontFaceColor->GrayLevel[0],
            BackFaceColor->GrayLevel[0],
            GraphicsColor->GrayLevel[0],
            FontSize->18,
            FontColor->GrayLevel[0]],
           Background->RGBColor[0.87, 0.94, 1],
           StripOnInput->False], {0.2661767228055947, -0.9403765852688368}],
         "DynamicName",
         BoxID -> "VertexID$7"]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{
  3.8425031626108522`*^9, 3.842503231297649*^9, 3.842503449907791*^9, 
   3.842503639769169*^9, 3.8425045241540613`*^9, 3.842504579159552*^9, 
   3.84250469980846*^9, 3.842504986618215*^9, 3.842505175116218*^9, {
   3.842505852185038*^9, 3.8425058960277863`*^9}, {3.842506438470245*^9, 
   3.842506449986897*^9}, {3.8425067773781843`*^9, 3.8425068267516403`*^9}, 
   3.84250692846872*^9, {3.842506985427507*^9, 3.842507009860952*^9}, {
   3.842507045697414*^9, 3.842507053069449*^9}, {3.842507092283306*^9, 
   3.8425071116628532`*^9}, {3.842507172175378*^9, 3.842507199828273*^9}, {
   3.842507314637372*^9, 3.842507345530375*^9}, 3.843902653314116*^9, 
   3.909653620832965*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"c2635f96-2c64-47bc-a7ad-b2c4d09dd406"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(m\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<(1 - p)\!\(\*SubscriptBox[\(f\), \(m\)]\) \!\(\*SubscriptBox[\(\
\[Eta]\), \(m\)]\)\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(mW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<2 p \!\(\*SubscriptBox[\(f\), \(m\)]\) \
\!\(\*SubscriptBox[\(\[Eta]\), \(m\)]\)\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(mm\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<p \!\(\*SuperscriptBox[SubscriptBox[\(f\), \(m\)], \(2\)]\) \
\!\(\*SubscriptBox[\(\[Eta]\), \(m\)]\)\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<q \!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(WW\)]\)\>\""}]}], "}"}], "]"}]], "Input",\

 CellChangeTimes->{{3.861153241697544*^9, 3.861153250363415*^9}, {
  3.861153295837248*^9, 3.861153318712111*^9}, {3.861153453596119*^9, 
  3.861153594448678*^9}, {3.8611536303252087`*^9, 3.8611536485214577`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"daa8bbab-d490-4c68-9622-d57c3145979c"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(m\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(mW\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(mm\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)", "W"}, {{{1, 
       2}, {1, 3}, {1, 4}, {5, 6}, {5, 7}, {6, 7}, {6, 8}, {7, 8}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)"] -> Placed[
           Style[
           "\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(mm\)]\)"] -> Placed[
           Style[
           "p \!\(\*SuperscriptBox[SubscriptBox[\(f\), \(m\)], \(2\)]\) \
\!\(\*SubscriptBox[\(\[Eta]\), \(m\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(mW\)]\)"] -> Placed[
           Style[
           "2 p \!\(\*SubscriptBox[\(f\), \(m\)]\) \
\!\(\*SubscriptBox[\(\[Eta]\), \(m\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)"] -> Placed[
           Style[
           "\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
2(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)", "W"] -> 
         Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(m\)]\)"] -> Placed[
           Style[
           "(1 - p)\!\(\*SubscriptBox[\(f\), \(m\)]\) \!\(\*SubscriptBox[\(\
\[Eta]\), \(m\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)"] -> Placed[
           Style["q \!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredEmbedding", "RootVertex" -> "W", "Orientation" -> Top, 
         "LeafDistance" -> 4}, ImageSize -> 450, PerformanceGoal -> "Quality",
        VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]], Typeset`boxes, 
    Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[Medium], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"(1 - p)\\!\\(\\*SubscriptBox[\\(f\\), \\(m\\)]\\) \
\\!\\(\\*SubscriptBox[\\(\[Eta]\\), \\(m\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$1", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$3", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$2"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"2 p \\!\\(\\*SubscriptBox[\\(f\\), \\(m\\)]\\) \
\\!\\(\\*SubscriptBox[\\(\[Eta]\\), \\(m\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$2", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$3"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"p \\!\\(\\*SuperscriptBox[SubscriptBox[\\(f\\), \\(m\\)], \
\\(2\\)]\\) \\!\\(\\*SubscriptBox[\\(\[Eta]\\), \\(m\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$3", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$6", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$4"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(W\\)]\\) + \
2(1-q)\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$4", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$5"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"q \\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$5", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$6"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(W\\)]\\) + \
2(1-q)\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$6", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$8", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$7"], 
        InsetBox[
         FormBox[
          StyleBox["\"\\!\\(\\*SubscriptBox[\\(f\\), \\(W\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$7", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$7", Automatic, Center], 
           DynamicLocation["VertexID$8", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$8"], 
        InsetBox[
         FormBox[
          StyleBox["\"\\!\\(\\*SubscriptBox[\\(f\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$8", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(S\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.4621856990601627`, -1.5475166970290108`}], 
        "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(m\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.2911056115219228, -1.8402867189135708`}], 
        "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(mW\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.4621856990601627`, -1.8402867189135708`}], 
        "DynamicName", BoxID -> "VertexID$3"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(mm\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {2.6332657865984026`, -1.8402867189135708`}], 
        "DynamicName", BoxID -> "VertexID$4"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(S\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.9653054739851649, -0.29110561152192294`}], 
        "DynamicName", BoxID -> "VertexID$5"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(W\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.2911056115219228, -0.628205542753544}], 
        "DynamicName", BoxID -> "VertexID$6"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(WW\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.639505336448407, -0.628205542753544}], 
        "DynamicName", BoxID -> "VertexID$7"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"W\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.2911056115219228, -0.965305473985165}], 
        "DynamicName", BoxID -> "VertexID$8"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{-1.4210854715202004`*^-14, 
       674.9999999999999}, {-229.95281305076787`, 222.00000000000006`}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{3.861153596468422*^9, 3.861153651453244*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"7516f7f4-5328-4889-ae58-0d724c1c3576"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formatting setup", "Section",
 CellChangeTimes->{{3.8423525559883757`*^9, 
  3.842352558202939*^9}},ExpressionUUID->"7c5bf8c7-c385-4ce6-864c-\
3bf45548f3ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"gstyle", ",", "makeEpiModelGraph", ",", "imakeEpiModelGraph"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gstyle", "[", "str_", "]"}], " ", ":=", " ", 
  RowBox[{"Style", "[", 
   RowBox[{"str", ",", " ", "Black", ",", " ", "18"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"makeEpiModelGraph", "[", 
   RowBox[{"info", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{"_DirectedEdge", ",", " ", "_String"}], "]"}], ".."}], "}"}]}],
    "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"edges", ",", " ", "g"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"info", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"imakeEpiModelGraph", "[", 
       RowBox[{"info", ",", " ", "edges", ",", " ", "Top"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Less", "@@", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"(", 
           RowBox[{"MinMax", "/@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"(", 
              RowBox[{"VertexCoordinates", " ", "/.", " ", 
               RowBox[{"AbsoluteOptions", "[", 
                RowBox[{"g", ",", " ", "VertexCoordinates"}], "]"}]}], 
              ")"}]}]}], ")"}]}]}]}], ",", "\n", "\t\t", 
       RowBox[{"imakeEpiModelGraph", "[", 
        RowBox[{"info", ",", " ", "edges", ",", " ", "Left"}], "]"}], ",", 
       "\n", "\t\t", "g"}], "\n", "\t", "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"imakeEpiModelGraph", "[", 
   RowBox[{
    RowBox[{"info_", ":", "None"}], ",", " ", 
    RowBox[{"edges", ":", 
     RowBox[{"_DirectedEdge", "|", 
      RowBox[{"{", 
       RowBox[{"_DirectedEdge", ".."}], "}"}]}]}], ",", " ", 
    RowBox[{"orientation_", ":", "Top"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Graph", "[", "\n", "\t\t", 
   RowBox[{"edges", ",", "\n", "\t\t", 
    RowBox[{"VertexShapeFunction", "\[Rule]", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy", ",", " ", "v", ",", " ", "wh"}], "}"}], ",", " ", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"Framed", "[", 
          RowBox[{
           RowBox[{"gstyle", "[", "v", "]"}], ",", " ", 
           RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], ",", " ", 
         "xy"}], "]"}]}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"EdgeLabels", " ", "\[Rule]", " ", 
     RowBox[{"(", 
      RowBox[{"info", " ", "/.", " ", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"edg_", ",", " ", "str_String"}], "]"}], " ", 
        "\[RuleDelayed]", " ", 
        RowBox[{"Rule", "[", 
         RowBox[{"edg", ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"gstyle", "@", "str"}], ",", " ", "0.5"}], "]"}]}], 
         "]"}]}]}], ")"}]}], ",", "\n", "\t\t", 
    RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", "\n", 
    "\t\t", 
    RowBox[{"ImageSize", "\[Rule]", "450"}], ",", "\n", "\t\t", 
    RowBox[{"GraphLayout", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<LayeredEmbedding\>\"", ",", 
       RowBox[{"\"\<RootVertex\>\"", "\[Rule]", "\"\<W\>\""}], ",", 
       RowBox[{"\"\<Orientation\>\"", "\[Rule]", "orientation"}], ",", " ", 
       RowBox[{"\"\<LeafDistance\>\"", " ", "->", " ", "4"}]}], "}"}]}]}], 
   "\n", "\t", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.842353398085217*^9, {3.842506434691255*^9, 3.842506445873101*^9}, {
   3.842506724553074*^9, 3.842506824097136*^9}, 3.842506924422892*^9, {
   3.842506979428041*^9, 3.842507050620466*^9}, {3.842507083309786*^9, 
   3.842507195649665*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"7291827d-cbce-40b3-9277-ba3c6178e13f"]
}, Open  ]]
},
WindowSize->{1135.8, 574.8},
WindowMargins->{{Automatic, 0.6000000000001364}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification->1.5,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"319e0778-45a6-498b-9ec0-010afa42a961"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2291, 48, 299, "Input",ExpressionUUID->"380efcab-9472-41c1-887d-de8fda890912"],
Cell[2874, 72, 13551, 325, 356, "Output",ExpressionUUID->"d4749f87-8067-4712-8e28-ee9f8682c91e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16462, 402, 1201, 28, 113, "Input",ExpressionUUID->"e8ebf195-1dbd-4ea9-aa06-86ec9f105310"],
Cell[17666, 432, 7818, 176, 411, "Output",ExpressionUUID->"60e8eaa8-cbf1-40aa-9842-b101b0fe0129"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25521, 613, 2952, 65, 243, "Input",ExpressionUUID->"ffc40bd8-6ec4-47a8-b15d-0cb56d99aae6"],
Cell[28476, 680, 13413, 318, 654, "Output",ExpressionUUID->"c2635f96-2c64-47bc-a7ad-b2c4d09dd406"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41926, 1003, 3049, 69, 278, "Input",ExpressionUUID->"daa8bbab-d490-4c68-9622-d57c3145979c"],
Cell[44978, 1074, 13034, 305, 495, "Output",ExpressionUUID->"7516f7f4-5328-4889-ae58-0d724c1c3576"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58049, 1384, 163, 3, 100, "Section",ExpressionUUID->"7c5bf8c7-c385-4ce6-864c-3bf45548f3ac"],
Cell[58215, 1389, 3937, 97, 814, "Input",ExpressionUUID->"7291827d-cbce-40b3-9277-ba3c6178e13f"]
}, Open  ]]
}
]
*)

