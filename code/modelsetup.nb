(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43510,       1031]
NotebookOptionsPosition[     42301,       1001]
NotebookOutlinePosition[     42743,       1018]
CellTagsIndexPosition[     42700,       1015]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<W\>\"", "\[DirectedEdge]", "\"\<\[ScriptCapitalQ]\>\""}], 
     " ", "\[Rule]", " ", 
     "\"\<qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<\[ScriptCapitalR]\>\""}], " ", "\[Rule]", 
     " ", "\"\<\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\"\
"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<\[ScriptCapitalR]\>\""}], " ", "\[Rule]", 
     " ", "\"\<\[Gamma]2\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalQ]\>\"\
"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(D\), \(W\)]\)\>\"", " ", "\[DirectedEdge]", 
      " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(D\), \(WW\)]\)\>\"", " ", "\[DirectedEdge]", 
      " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<W\>\"", " ", "\[DirectedEdge]", " ", "\"\<DeadPool\>\""}], 
     " ", "\[Rule]", " ", "\"\<\[Delta]\>\""}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.842353405858324*^9, 3.8423534111522913`*^9}, {
  3.842353443634672*^9, 3.8423535128951483`*^9}, {3.8423695782255583`*^9, 
  3.842369662646483*^9}, {3.842499018129982*^9, 3.842499028565138*^9}, {
  3.842499141257599*^9, 3.842499164650239*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"380efcab-9472-41c1-887d-de8fda890912"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", "W", 
       "\[ScriptCapitalQ]", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)", 
       "\[ScriptCapitalR]", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)", 
       "\!\(\*SubscriptBox[\(D\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(D\), \(WW\)]\)", "DeadPool"}, {{{1, 2}, {2, 3}, {
       4, 5}, {6, 5}, {7, 2}, {8, 2}, {2, 9}}, Null}, {
      EdgeLabels -> {DirectedEdge["W", "\[ScriptCapitalQ]"] -> Placed[
           Style["qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)", 
           "\[ScriptCapitalR]"] -> Placed[
           Style["\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\!\(\*SubscriptBox[\(D\), \(WW\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], DirectedEdge["W", "DeadPool"] -> Placed[
           Style["\[Delta]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", "W"] -> Placed[
           Style[
           "\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)", 
           "\[ScriptCapitalR]"] -> Placed[
           Style["\[Gamma]2\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalQ]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\!\(\*SubscriptBox[\(D\), \(W\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredDigraphEmbedding", "RootVertex" -> "W", "Orientation" -> Top},
        ImageSize -> 450, PerformanceGoal -> "Quality", VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]], Typeset`boxes, 
    Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[Medium], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*FractionBox[\\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\\), \\(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$1", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$3", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$2"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$2", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$9", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$3"], 
        InsetBox[
         FormBox[
          StyleBox["\"\[Delta]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$3", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$4", Automatic, Center], 
           DynamicLocation["VertexID$5", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$4"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$4", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$5", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$5"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\[Gamma]2\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalQ]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$5", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$7", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$6"], 
        InsetBox[
         FormBox[
          StyleBox["\"\\!\\(\\*SubscriptBox[\\(f\\), \\(W\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$6", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$8", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$7"], 
        InsetBox[
         FormBox[
          StyleBox["\"\\!\\(\\*SubscriptBox[\\(f\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$7", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(S\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.4375099999999996, -1.43751}], "DynamicName", 
        BoxID -> "VertexID$1"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"W\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {2.4375099999999996`, -0.43751000000000007`}], 
        "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalQ]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.4375099999999996`, -1.43751}], "DynamicName",
         BoxID -> "VertexID$3"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(W\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.43751000000000007`, -2.31253}], 
        "DynamicName", BoxID -> "VertexID$4"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalR]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.43751, -3.31253}], "DynamicName", BoxID -> 
        "VertexID$5"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(WW\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.43751, -2.31253}], "DynamicName", BoxID -> 
        "VertexID$6"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\\!\\(\\*SubscriptBox[\\(D\\), \\(W\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {2.4375099999999996`, -1.43751}], "DynamicName",
         BoxID -> "VertexID$7"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\\!\\(\\*SubscriptBox[\\(D\\), \\(WW\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {3.4375099999999996`, -1.43751}], "DynamicName",
         BoxID -> "VertexID$8"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"DeadPool\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {4.43751, -1.43751}], "DynamicName", BoxID -> 
        "VertexID$9"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{7.105427357601002*^-15, 674.}, {-237.00000000000009`, 
       227.59665499999997`}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{{3.842353174436042*^9, 3.842353196267269*^9}, {
   3.8423534311154203`*^9, 3.8423534629085693`*^9}, 3.84235351429354*^9, {
   3.842369617301797*^9, 3.8423696633561573`*^9}, {3.8424343889347353`*^9, 
   3.842434402881682*^9}, {3.84249914943582*^9, 3.842499165034878*^9}},
 CellLabel->"Out[68]=",ExpressionUUID->"dc816797-0149-4628-aa3b-8a45bd2d7be5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalS]\>\"", " ", "\[DirectedEdge]", 
      "\"\<\[ScriptCapitalI]\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)\>\""}], ",", 
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalI]\>\"", "\[DirectedEdge]", 
      "\"\<\[ScriptCapitalQ]\>\""}], " ", "\[Rule]", " ", 
     "\"\<qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\""}], ",", 
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalI]\>\"", " ", "\[DirectedEdge]", " ", 
      "\"\<\[ScriptCapitalR]\>\""}], " ", "\[Rule]", " ", 
     "\"\<\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\>\""}], 
    ",", 
    RowBox[{
     RowBox[{
     "\"\<\[ScriptCapitalR]\>\"", "\[DirectedEdge]", 
      "\"\<\[ScriptCapitalS]\>\""}], "->", "\"\<\[Delta]\>\""}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.84235323324651*^9, 3.8423532700048857`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e8ebf195-1dbd-4ea9-aa06-86ec9f105310"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\[ScriptCapitalS]", "\[ScriptCapitalI]", "\[ScriptCapitalQ]", 
       "\[ScriptCapitalR]"}, {{{1, 2}, {2, 3}, {2, 4}, {4, 1}}, Null}, {
      EdgeLabels -> {
        DirectedEdge["\[ScriptCapitalI]", "\[ScriptCapitalQ]"] -> Placed[
           Style["qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\[ScriptCapitalR]", "\[ScriptCapitalS]"] -> Placed[
           Style["\[Delta]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\[ScriptCapitalI]", "\[ScriptCapitalR]"] -> Placed[
           Style["\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge["\[ScriptCapitalS]", "\[ScriptCapitalI]"] -> Placed[
           Style[
           "\!\(\*FractionBox[\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\), \(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredDigraphEmbedding", "RootVertex" -> "\[ScriptCapitalS]", 
         "Orientation" -> Left}, ImageSize -> 450, PerformanceGoal -> 
       "Quality", VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]], Typeset`boxes, 
    Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[Medium], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*FractionBox[\\(\[Beta]\[ThinSpace]\[Cross]\[ThinSpace]\
\[ScriptCapitalS]\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\\), \\(\
\[ScriptCapitalN] - \[ScriptCapitalQ][t]\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$1", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$3", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$2"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"qr\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$2", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$3"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\[Gamma]1\[ThinSpace]\[Cross]\[ThinSpace]\[ScriptCapitalI]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$3", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[
          BezierCurveBox[{
            DynamicLocation[
            "VertexID$4", Automatic, Center], {-0.2172839238223868, 
            1.0000000058221008`}, {-0.28395059048905347`, 
            1.0000000076084272`}, {-0.3555555287606583, 
            1.0000000095270742`}, {-0.4320987386372015, 
            1.0000000115780416`}, {-0.513580220118683, 
            1.0000000137613296`}, {-0.5999999732051027, 
            1.000000016076938}, {-0.6874424759218108, 
            0.9965081330807579}, {-0.7719922062941575, 
            0.9860324793286808}, {-0.8536491643221427, 
            0.9685730548207067}, {-0.9324133500057663, 
            0.9441298595568349}, {-1.0082847633450285`, 
            0.9127028935370661}, {-1.0812634043399294`, 
            0.8742921567614004}, {-1.1513492729904686`, 
            0.828897649229837}, {-1.2185423692966464`, 
            0.7765193709423768}, {-1.2828426932584627`, 
            0.7171573218990192}, {-1.3938510158370114`, 
            0.6061490052693834}, {-1.4970282940692992`, 
            0.5029717325663448}, {-1.5923745279553256`, 
            0.40762550378990325`}, {-1.679889717495091, 
            0.3201103189400588}, {-1.7595738626885948`, 0.24042617801681163`}, 
            DynamicLocation["VertexID$1", Automatic, Center]}]], 
         "DynamicName", BoxID -> "EdgeLabelID$4"], 
        InsetBox[
         FormBox[
          StyleBox["\"\[Delta]\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$4", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalS]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {-1.9999999999999993`, 
         5.3589794058235685`*^-8}], "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalI]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {-0.9999999999999997, 2.6794897029117842`*^-8}],
         "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalQ]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0., 0.}], "DynamicName", BoxID -> 
        "VertexID$3"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"\[ScriptCapitalR]\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {2.6794897029117842`*^-8, 0.9999999999999997}], 
        "DynamicName", BoxID -> "VertexID$4"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{1.1368683772161603`*^-13, 
       673.9999999999999}, {-187.99999999999994`, 178.99999571281649`}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{3.842353235150687*^9, 3.8423532707918367`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"60e8eaa8-cbf1-40aa-9842-b101b0fe0129"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeEpiModelGraph", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<(1 - p)\!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)\>\"", 
      "\[DirectedEdge]", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", "\"\<p \!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\)+ \
(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<q \!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", 
      "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\""}], " ", 
     "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(W\)]\)\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)\>\"", " ", 
      "\[DirectedEdge]", " ", "\"\<W\>\""}], " ", "\[Rule]", " ", 
     "\"\<\!\(\*SubscriptBox[\(f\), \(WW\)]\)\>\""}]}], "}"}], "]"}]], "Input",\

 CellChangeTimes->{{3.8425030331323557`*^9, 3.8425030855815487`*^9}, {
  3.842503158381469*^9, 3.842503230350486*^9}, {3.84250338896522*^9, 
  3.8425034462125187`*^9}, {3.8425035707219467`*^9, 3.842503639040506*^9}, {
  3.842504437759941*^9, 3.842504698583741*^9}, {3.842504959051269*^9, 
  3.842504973852881*^9}, {3.842505058024083*^9, 3.842505090667911*^9}, {
  3.8425051811691847`*^9, 3.8425052065191307`*^9}, {3.842505850813733*^9, 
  3.842505895372611*^9}, {3.842507242311509*^9, 3.842507341095758*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"ffc40bd8-6ec4-47a8-b15d-0cb56d99aae6"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{
      "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", 
       "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)", "W"}, {{{1, 
       2}, {1, 3}, {4, 5}, {4, 6}, {5, 6}, {5, 7}, {6, 7}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", "W"] -> Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)"] -> Placed[
           Style[
           "\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\) + \
(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(W\)]\)"] -> Placed[
           Style[
           "\!\(\*SubscriptBox[\(\[Lambda]\), \(W\)]\)+ \
(1-q)\!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(W\)]\)"] -> Placed[
           Style["(1 - p)\!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalI]\), \(WW\)]\)"] -> Placed[
           Style["p \!\(\*SubscriptBox[\(\[Eta]\), \(W\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)", "W"] -> 
         Placed[
           Style["\!\(\*SubscriptBox[\(f\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5], 
         DirectedEdge[
          "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(S\)]\)", 
           "\!\(\*SubscriptBox[\(\[ScriptCapitalD]\), \(WW\)]\)"] -> Placed[
           Style["q \!\(\*SubscriptBox[\(\[Lambda]\), \(WW\)]\)", 
            GrayLevel[0], 18], 0.5]}, 
       GraphLayout -> {
        "LayeredEmbedding", "RootVertex" -> "W", "Orientation" -> Top, 
         "LeafDistance" -> 4}, ImageSize -> 450, PerformanceGoal -> "Quality",
        VertexShapeFunction -> {
         Function[{$CellContext`xy, $CellContext`v, $CellContext`wh}, 
          Inset[
           Framed[
            $CellContext`gstyle[$CellContext`v], Background -> 
            LightBlue], $CellContext`xy]]}}]], Typeset`boxes, 
    Typeset`boxes$s2d = GraphicsGroupBox[{{
       Arrowheads[Medium], 
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$1"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"(1 - p)\\!\\(\\*SubscriptBox[\\(\[Eta]\\), \\(W\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$1", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$3", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$2"], 
        InsetBox[
         FormBox[
          StyleBox["\"p \\!\\(\\*SubscriptBox[\\(\[Eta]\\), \\(W\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$2", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$4", Automatic, Center], 
           DynamicLocation["VertexID$5", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$3"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(W\\)]\\)+ \
(1-q)\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$3", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$4", Automatic, Center], 
           DynamicLocation["VertexID$6", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$4"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"q \\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$4", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$6", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$5"], 
        InsetBox[
         FormBox[
          StyleBox[
          "\"\\!\\(\\*SubscriptBox[\\(\[Lambda]\\), \\(W\\)]\\) + (1-q)\\!\\(\
\\*SubscriptBox[\\(\[Lambda]\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$5", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$6"], 
        InsetBox[
         FormBox[
          StyleBox["\"\\!\\(\\*SubscriptBox[\\(f\\), \\(W\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$6", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}, {
        TagBox[
         ArrowBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], "DynamicName", 
         BoxID -> "EdgeLabelID$7"], 
        InsetBox[
         FormBox[
          StyleBox["\"\\!\\(\\*SubscriptBox[\\(f\\), \\(WW\\)]\\)\"", 
           GrayLevel[0], 18, StripOnInput -> False], TraditionalForm], 
         Offset[{0, 2}, 
          DynamicLocation["EdgeLabelID$7", Automatic, 
           Scaled[0.5]]], 
         ImageScaled[{0.5, 0}], BaseStyle -> "Graphics"]}}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(S\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.1606039138055106`, -1.4727300308800262`}], 
        "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(W\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.2661767228055948, -1.919943626379984}], 
        "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalI]\\), \\(WW\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {2.0550311048054266`, -1.919943626379984}], 
        "DynamicName", BoxID -> "VertexID$3"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(S\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.9403765852688367, -0.2661767228055948}], 
        "DynamicName", BoxID -> "VertexID$4"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(W\\)]\\)\"", 
             
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.2661767228055947, -0.6032766540372159}], 
        "DynamicName", BoxID -> "VertexID$5"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox[
            "\"\\!\\(\\*SubscriptBox[\\(\[ScriptCapitalD]\\), \\(WW\\)]\\)\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {1.6145764477320788`, -0.6032766540372159}], 
        "DynamicName", BoxID -> "VertexID$6"], 
       TagBox[
        InsetBox[
         BoxData[
          FormBox[
           FrameBox[
            StyleBox["\"W\"", 
             GrayLevel[0], 18, StripOnInput -> False], Background -> 
            RGBColor[0.87, 0.94, 1], StripOnInput -> False], 
           TraditionalForm]], {0.2661767228055947, -0.9403765852688368}], 
        "DynamicName", BoxID -> "VertexID$7"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{7.105427357601002*^-15, 449.}, {-206., 
       201.45369865041562`}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->450]], "Output",
 CellChangeTimes->{
  3.8425031626108522`*^9, 3.842503231297649*^9, 3.842503449907791*^9, 
   3.842503639769169*^9, 3.8425045241540613`*^9, 3.842504579159552*^9, 
   3.84250469980846*^9, 3.842504986618215*^9, 3.842505175116218*^9, {
   3.842505852185038*^9, 3.8425058960277863`*^9}, {3.842506438470245*^9, 
   3.842506449986897*^9}, {3.8425067773781843`*^9, 3.8425068267516403`*^9}, 
   3.84250692846872*^9, {3.842506985427507*^9, 3.842507009860952*^9}, {
   3.842507045697414*^9, 3.842507053069449*^9}, {3.842507092283306*^9, 
   3.8425071116628532`*^9}, {3.842507172175378*^9, 3.842507199828273*^9}, {
   3.842507314637372*^9, 3.842507345530375*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"19d88852-fad7-4169-a73b-fdfac347fec4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formatting setup", "Section",
 CellChangeTimes->{{3.8423525559883757`*^9, 
  3.842352558202939*^9}},ExpressionUUID->"7c5bf8c7-c385-4ce6-864c-\
3bf45548f3ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"gstyle", ",", "makeEpiModelGraph", ",", "imakeEpiModelGraph"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gstyle", "[", "str_", "]"}], " ", ":=", " ", 
  RowBox[{"Style", "[", 
   RowBox[{"str", ",", " ", "Black", ",", " ", "18"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"makeEpiModelGraph", "[", 
   RowBox[{"info", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{"_DirectedEdge", ",", " ", "_String"}], "]"}], ".."}], "}"}]}],
    "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"edges", ",", " ", "g"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"info", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"imakeEpiModelGraph", "[", 
       RowBox[{"info", ",", " ", "edges", ",", " ", "Top"}], "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Less", "@@", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"(", 
           RowBox[{"MinMax", "/@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"(", 
              RowBox[{"VertexCoordinates", " ", "/.", " ", 
               RowBox[{"AbsoluteOptions", "[", 
                RowBox[{"g", ",", " ", "VertexCoordinates"}], "]"}]}], 
              ")"}]}]}], ")"}]}]}]}], ",", "\n", "\t\t", 
       RowBox[{"imakeEpiModelGraph", "[", 
        RowBox[{"info", ",", " ", "edges", ",", " ", "Left"}], "]"}], ",", 
       "\n", "\t\t", "g"}], "\n", "\t", "]"}]}]}], "\n", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"imakeEpiModelGraph", "[", 
   RowBox[{
    RowBox[{"info_", ":", "None"}], ",", " ", 
    RowBox[{"edges", ":", 
     RowBox[{"_DirectedEdge", "|", 
      RowBox[{"{", 
       RowBox[{"_DirectedEdge", ".."}], "}"}]}]}], ",", " ", 
    RowBox[{"orientation_", ":", "Top"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Graph", "[", "\n", "\t\t", 
   RowBox[{"edges", ",", "\n", "\t\t", 
    RowBox[{"VertexShapeFunction", "\[Rule]", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy", ",", " ", "v", ",", " ", "wh"}], "}"}], ",", " ", 
       RowBox[{"Inset", "[", 
        RowBox[{
         RowBox[{"Framed", "[", 
          RowBox[{
           RowBox[{"gstyle", "[", "v", "]"}], ",", " ", 
           RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], ",", " ", 
         "xy"}], "]"}]}], "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"EdgeLabels", " ", "\[Rule]", " ", 
     RowBox[{"(", 
      RowBox[{"info", " ", "/.", " ", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"edg_", ",", " ", "str_String"}], "]"}], " ", 
        "\[RuleDelayed]", " ", 
        RowBox[{"Rule", "[", 
         RowBox[{"edg", ",", " ", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"gstyle", "@", "str"}], ",", " ", "0.5"}], "]"}]}], 
         "]"}]}]}], ")"}]}], ",", "\n", "\t\t", 
    RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", "\n", 
    "\t\t", 
    RowBox[{"ImageSize", "\[Rule]", "450"}], ",", "\n", "\t\t", 
    RowBox[{"GraphLayout", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<LayeredEmbedding\>\"", ",", 
       RowBox[{"\"\<RootVertex\>\"", "\[Rule]", "\"\<W\>\""}], ",", 
       RowBox[{"\"\<Orientation\>\"", "\[Rule]", "orientation"}], ",", " ", 
       RowBox[{"\"\<LeafDistance\>\"", " ", "->", " ", "4"}]}], "}"}]}]}], 
   "\n", "\t", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.842353398085217*^9, {3.842506434691255*^9, 3.842506445873101*^9}, {
   3.842506724553074*^9, 3.842506824097136*^9}, 3.842506924422892*^9, {
   3.842506979428041*^9, 3.842507050620466*^9}, {3.842507083309786*^9, 
   3.842507195649665*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"7291827d-cbce-40b3-9277-ba3c6178e13f"]
}, Open  ]]
},
WindowSize->{777, 762},
WindowMargins->{{12, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification->1.5,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"319e0778-45a6-498b-9ec0-010afa42a961"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2009, 43, 99, "Input",ExpressionUUID->"380efcab-9472-41c1-887d-de8fda890912"],
Cell[2592, 67, 11652, 268, 515, "Output",ExpressionUUID->"c2bd65b8-325b-473a-a424-ba871316258b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14281, 340, 1201, 28, 78, "Input",ExpressionUUID->"e8ebf195-1dbd-4ea9-aa06-86ec9f105310"],
Cell[15485, 370, 7848, 177, 264, "Output",ExpressionUUID->"60e8eaa8-cbf1-40aa-9842-b101b0fe0129"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23370, 552, 2899, 64, 178, "Input",ExpressionUUID->"ffc40bd8-6ec4-47a8-b15d-0cb56d99aae6"],
Cell[26272, 618, 11874, 273, 448, "Output",ExpressionUUID->"19d88852-fad7-4169-a73b-fdfac347fec4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38183, 896, 163, 3, 67, "Section",ExpressionUUID->"7c5bf8c7-c385-4ce6-864c-3bf45548f3ac"],
Cell[38349, 901, 3936, 97, 619, "Input",ExpressionUUID->"7291827d-cbce-40b3-9277-ba3c6178e13f"]
}, Open  ]]
}
]
*)

