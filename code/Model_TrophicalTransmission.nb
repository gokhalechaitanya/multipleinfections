(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24475,        694]
NotebookOptionsPosition[     22495,        651]
NotebookOutlinePosition[     22984,        670]
CellTagsIndexPosition[     22941,        667]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["General ODE systems", "Title",
 CellChangeTimes->{{3.875951631497954*^9, 
  3.875951637484686*^9}},ExpressionUUID->"4f7b14d0-68a4-4e9e-8844-\
dfc69569ebae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dIsdt", " ", "=", " ", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"Iw", ",", " ", "Is", ",", " ", "Iww"}], "]"}], "-", " ", 
    RowBox[{"d", " ", "Is"}], "-", " ", 
    RowBox[{
     RowBox[{"\[CapitalPi]s", "[", 
      RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww"}], "]"}], " ", "Is"}], 
    "  ", "-", " ", 
    RowBox[{"\[Eta]", "  ", "Is"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dIwdt", " ", "=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "\[Eta]", " ", "Is"}], "  ", "-", " ", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", " ", "+", " ", "\[Alpha]w"}], ")"}], "Iw"}], " ", "-", 
     " ", 
     RowBox[{
      RowBox[{"\[CapitalPi]w", "[", 
       RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]w"}], 
       "]"}], "Iw"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dIwwdt", " ", "=", "  ", 
    RowBox[{
     RowBox[{"p", " ", "\[Eta]", " ", "Is"}], "  ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", " ", "+", " ", "\[Alpha]ww"}], ")"}], "Iww"}], " ", "-", 
     " ", 
     RowBox[{
      RowBox[{"\[CapitalPi]ww", "[", 
       RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww", ",", "\[Beta]ww"}], 
       "]"}], "Iww"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dDsdt", " ", "=", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{
     "Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "Is", ",", " ", "Iw", ",", 
      " ", "Iww"}], "]"}], "  ", "-", " ", 
    RowBox[{"\[Mu]", " ", "Ds"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]ww", " ", "+", " ", "\[Lambda]w"}], ")"}], " ", 
     "Ds"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dDwdt", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]w", " ", "+", " ", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}]}], ")"}], " ", 
     "Ds"}], "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Mu]", " ", "+", " ", "\[Sigma]w"}], ")"}], " ", "Dw"}], " ", 
    "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}], " ", "+", 
       "\[Lambda]w"}], ")"}], "Dw"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dDwwdt", " ", "=", " ", 
   RowBox[{
    RowBox[{"q", " ", "\[Lambda]ww", " ", "Ds"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}], " ", "+", " ", 
       "\[Lambda]w"}], ")"}], "Dw"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Mu]", " ", "+", " ", "\[Sigma]ww"}], ")"}], "Dww"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dWdt", " ", "=", " ", 
    RowBox[{
     RowBox[{"fw", " ", "Dw"}], " ", "+", 
     RowBox[{"fww", " ", "Dww"}], "-", " ", 
     RowBox[{"\[Delta]", " ", "W"}], " ", "-", " ", 
     RowBox[{"\[Eta]", " ", "Is"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"forceInf", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Eta]", "->", " ", 
      RowBox[{"\[Gamma]", " ", "W"}]}], ",", " ", 
     RowBox[{"\[Lambda]w", " ", "->", " ", 
      RowBox[{"\[Beta]w", " ", "Iw"}]}], ",", " ", 
     RowBox[{"\[Lambda]ww", " ", "->", " ", 
      RowBox[{"\[Beta]ww", " ", "Iww"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"odesRes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "dIsdt", ",", " ", "dIwdt", ",", " ", "dIwwdt", ",", " ", "dDsdt", ",", 
     " ", "dDwdt", ",", " ", "dDwwdt", ",", " ", "dWdt"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varRes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "Is", ",", " ", "Iw", ",", " ", "Iww", ",", " ", "Ds", ",", " ", "Dw", 
     ",", " ", "Dww", ",", " ", "W"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.875935309110186*^9, 3.875935309456818*^9}, {
   3.875951795932485*^9, 3.875951814642809*^9}, 3.875952196979055*^9},
 CellLabel->
  "In[314]:=",ExpressionUUID->"69a77141-568c-4912-a97d-032f08a58f23"]
}, Open  ]],

Cell[CellGroupData[{

Cell["R0 using next generation matrix", "Title",
 CellChangeTimes->{{3.87595165075362*^9, 
  3.87595166348936*^9}},ExpressionUUID->"bf247886-d604-4161-b247-\
a789cee3b752"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"varPar", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "Iw", ",", " ", "Iww", ",", " ", "Dw", ",", " ", "Dww", ",", " ", "W"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "d"}], " ", "-", " ", "\[Alpha]w", " ", "-", " ", 
        RowBox[{"\[CapitalPi]w", "[", 
         RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]w"}], 
         "]"}]}], ",", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}], "\[Gamma]", " ", "Is"}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{
        RowBox[{"-", "d"}], " ", "-", " ", "\[Alpha]ww", " ", "-", " ", 
        RowBox[{"\[CapitalPi]ww", "[", 
         RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww", ",", "\[Beta]ww"}], 
         "]"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{"p", " ", "\[Gamma]", " ", "Is"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Beta]w", " ", "Ds"}], ",", " ", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "-", "q"}], ")"}], " ", "\[Beta]ww", " ", "Ds"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"-", " ", "\[Mu]"}], " ", "-", " ", "\[Sigma]w", "-", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}], " ", "+", 
          "\[Lambda]w"}], ")"}]}], ",", " ", "0", ",", " ", "0"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"q", " ", "\[Beta]ww", " ", "Ds"}], ",", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}], " ", "+", " ", 
         "\[Lambda]w"}], ")"}], ",", " ", 
       RowBox[{
        RowBox[{"-", " ", "\[Mu]"}], " ", "-", " ", "\[Sigma]ww"}], ",", " ", 
       "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "fw", ",", " ", "fww", ",", " ", 
       RowBox[{
        RowBox[{"-", " ", "\[Delta]"}], " ", "-", " ", 
        RowBox[{"\[Gamma]", " ", "Is"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dIwdt", ",", " ", "dIwwdt", ",", " ", "dDwdt", ",", " ", "dDwwdt", ",",
        " ", "dWdt"}], "}"}], "==", 
     RowBox[{"Mmatrix", ".", "varPar"}]}], "}"}], "/.", "forceInf"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "fw", ",", " ", "fww", ",", " ", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", " ", "+", " ", "\[Alpha]w", " ", "+", " ", 
        RowBox[{"\[CapitalPi]w", "[", 
         RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]w"}], 
         "]"}]}], ",", "0", ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}]}], "\[Gamma]", " ", "Is"}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"d", " ", "+", " ", "\[Alpha]ww", " ", "+", " ", 
        RowBox[{"\[CapitalPi]ww", "[", 
         RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww", ",", "\[Beta]ww"}], 
         "]"}]}], ",", " ", "0", ",", " ", "0", ",", " ", 
       RowBox[{
        RowBox[{"-", "p"}], " ", "\[Gamma]", " ", "Is"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Beta]w"}], " ", "Ds"}], ",", 
       RowBox[{
        RowBox[{"-", " ", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "q"}], ")"}], " ", "\[Beta]ww", " ", "Ds"}], ",", 
       "  ", 
       RowBox[{"\[Mu]", " ", "+", " ", "\[Sigma]w", "+", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}], " ", "+", 
          "\[Lambda]w"}], ")"}]}], ",", " ", "0", ",", " ", "0"}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", " ", "q"}], " ", "\[Beta]ww", " ", "Ds"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "-", "q"}], ")"}], "\[Lambda]ww"}], " ", "+", " ", 
          "\[Lambda]w"}], ")"}]}], ",", "  ", 
       RowBox[{"\[Mu]", " ", "+", " ", "\[Sigma]ww"}], ",", " ", "0"}], "}"}],
      ",", "  ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", "  ", 
       RowBox[{"\[Delta]", " ", "+", " ", 
        RowBox[{"\[Gamma]", " ", "Is"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fmatrix", " ", "-", " ", "Vmatrix"}], " ", "==", " ", "Mmatrix"}],
   " ", "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8759516690076447`*^9, 3.875951672066139*^9}, {
  3.8759517114006777`*^9, 3.875952017367032*^9}, {3.875952056430286*^9, 
  3.87595205671017*^9}, {3.8759521287564373`*^9, 3.875952420985097*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"8a02a530-1166-4ba7-935f-5e727bc3d247"],

Cell[BoxData[
 RowBox[{"{", "True", "}"}]], "Output",
 CellChangeTimes->{{3.875952012700159*^9, 3.8759520177627277`*^9}, 
   3.8759520613741837`*^9, {3.875952129714572*^9, 3.8759522612016773`*^9}, 
   3.875952421353998*^9},
 CellLabel->
  "Out[341]=",ExpressionUUID->"9c6362f6-279d-4afb-ad2c-58f72281db2b"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.875952012700159*^9, 3.8759520177627277`*^9}, 
   3.8759520613741837`*^9, {3.875952129714572*^9, 3.8759522612016773`*^9}, 
   3.875952421356791*^9},
 CellLabel->
  "Out[344]=",ExpressionUUID->"d0f4408d-8414-44ac-8f9a-808e892d5f76"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", " ", "Is", 
     FractionBox[
      RowBox[{" ", 
       RowBox[{"p", " ", "q", " ", "\[Beta]ww", " "}]}], 
      RowBox[{"\[Alpha]ww", "+", "d", "+", " ", 
       RowBox[{"\[CapitalPi]ww", "[", 
        RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww", ",", "\[Beta]ww"}], 
        "]"}]}]], "  ", 
     FractionBox[
      RowBox[{"Ds", " "}], 
      RowBox[{"\[Mu]", "+", "\[Sigma]ww"}]], " ", 
     FractionBox["fww", 
      RowBox[{"\[Delta]", "+", 
       RowBox[{"\[Gamma]", " ", "Is"}]}]]}], " ", "+", "\n", 
    RowBox[{"\[Gamma]", " ", "Is", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}], "\[Beta]w"}], 
        RowBox[{"\[Alpha]w", "+", "d", "+", " ", 
         RowBox[{"\[CapitalPi]w", "[", 
          RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]w"}], 
          "]"}]}]], " ", "+", " ", 
       FractionBox[
        RowBox[{"2", " ", "p", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "q"}], ")"}], "\[Beta]ww"}], 
        RowBox[{"\[Alpha]ww", "+", "d", "+", " ", 
         RowBox[{"\[CapitalPi]ww", "[", 
          RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww", ",", "\[Beta]ww"}], 
          "]"}]}]]}], ")"}], "  ", 
     FractionBox["Ds", 
      RowBox[{" ", 
       RowBox[{"\[Mu]", "+", " ", "\[Sigma]w"}]}]], 
     FractionBox["fw", 
      RowBox[{"\[Delta]", "+", 
       RowBox[{"\[Gamma]", " ", "Is"}]}]]}]}], "==", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"Fmatrix", ".", 
         RowBox[{"Inverse", "[", "Vmatrix", "]"}]}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "/.", 
      RowBox[{"\[Lambda]w", "->", " ", "0"}]}], "/.", 
     RowBox[{"\[Lambda]ww", "->", " ", "0"}]}], ")"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.875952431902507*^9, 3.875952478777231*^9}, {
   3.875952520941331*^9, 3.875952619801779*^9}, {3.875952695398471*^9, 
   3.875953026879736*^9}, {3.8759536013303947`*^9, 3.875953612653096*^9}, 
   3.875953796571459*^9},
 CellLabel->
  "In[351]:=",ExpressionUUID->"9c0cf9f6-65ca-4731-9a3e-4ec1b8dd5c1d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.875952445247135*^9, 3.8759524797125683`*^9}, 
   3.8759529980306683`*^9, 3.87595361363787*^9, 3.875953797322588*^9, 
   3.875953861246272*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"11e58714-ddbf-4620-884a-01e5f551fd86"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"func0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"Iw", ",", " ", "Is", ",", " ", "Iww"}], "]"}], " ", "\[Rule]",
       " ", 
      RowBox[{"r", 
       RowBox[{"(", 
        RowBox[{"Is", " ", "+", " ", "Iw", "+", "Iww"}], ")"}]}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"\[CapitalPi]s", "[", 
       RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww"}], "]"}], "\[Rule]", " ", 
      RowBox[{"\[Rho]", 
       RowBox[{"(", 
        RowBox[{"Ds", " ", "+", "Dw", " ", "+", " ", "Dww"}], ")"}]}]}], ",", 
     " ", 
     RowBox[{
      RowBox[{"\[CapitalPi]w", "[", 
       RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]w"}], 
       "]"}], "\[Rule]", "  ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Rho]", " ", "+", " ", "\[Beta]w"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"Ds", " ", "+", " ", "Dw", "+", "Dww"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[CapitalPi]ww", "[", 
       RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]ww"}], 
       "]"}], "->", "  ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Beta]ww", " ", "+", " ", "\[Rho]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"Ds", " ", "+", " ", "Dw", "+", "Dww"}], ")"}]}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{
       "Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "Is", ",", " ", "Iw", ",", 
        " ", "Iww"}], "]"}], "\[Rule]", " ", 
      RowBox[{"\[Rho]", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"Ds", " ", "+", " ", "Dw", " ", "+", " ", "Dww"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"Is", " ", "+", " ", "Iw", "+", "Iww"}], ")"}]}]}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sysfunc0", " ", "=", " ", 
   RowBox[{
    RowBox[{"odesRes", "/.", "forceInf"}], "/.", "func0"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.875935391222439*^9, 3.875935403028083*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"f3b5d819-3c78-4171-9c50-752ee9a63e07"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"sysfunc0", " ", "==", " ", "0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Iww", "->", " ", "0"}], ",", " ", 
      RowBox[{"Iw", "->", " ", "0"}], ",", " ", 
      RowBox[{"Dww", "->", " ", "0"}], ",", " ", 
      RowBox[{"Dw", "->", " ", "0"}], ",", " ", 
      RowBox[{"W", "->", " ", "0"}]}], "}"}]}], ",", " ", "varRes"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.875935406045875*^9, 3.875935511631201*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"083ecbbc-2a7b-4874-aa34-6a79b9d5ae22"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    17, 1, 30338500834528437662, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.875935512138062*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"5a7ff0a2-d0f2-4682-ae36-fdc555a0a3f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Is", "\[Rule]", "0"}], ",", 
     RowBox[{"Ds", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Is", "\[Rule]", 
      FractionBox["\[Mu]", 
       RowBox[{"c", " ", "\[Rho]"}]]}], ",", 
     RowBox[{"Ds", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", "-", "r"}], "\[Rho]"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.875935407530505*^9, 3.8759354581515503`*^9, 
  3.875935512143546*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"645b1bad-7f5b-4221-bdb8-fdd5ae74ccb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"func1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"Iw", ",", " ", "Is", ",", " ", "Iww"}], "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"r", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"k", 
           RowBox[{"(", 
            RowBox[{"Is", " ", "+", " ", "Iw", "+", "Iww"}], ")"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Is", " ", "+", " ", "Iw", "+", "Iww"}], ")"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"\[CapitalPi]s", "[", 
        RowBox[{"Ds", ",", " ", "Dw", ",", " ", "Dww"}], "]"}], "\[Rule]", 
       " ", 
       RowBox[{"\[Rho]", 
        RowBox[{"(", 
         RowBox[{"Ds", " ", "+", "Dw", " ", "+", " ", "Dww"}], ")"}]}]}], ",",
       " ", 
      RowBox[{
       RowBox[{"\[CapitalPi]w", "[", 
        RowBox[{"Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "\[Beta]w"}], 
        "]"}], "\[Rule]", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Rho]", " ", "+", "\[Beta]w"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Ds", " ", "+", " ", "Dw", "+", " ", "Dww"}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"\[CapitalPi]ww", "[", 
        RowBox[{
        "Ds", ",", " ", "Dw", ",", " ", "Dww", ",", " ", "\[Beta]ww"}], "]"}],
        "->", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Rho]", "+", "\[Beta]ww"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Ds", " ", "+", " ", "Dw", "+", "Dww"}], ")"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"B", "[", 
        RowBox[{
        "Ds", ",", " ", "Dw", ",", "Dww", ",", " ", "Is", ",", " ", "Iw", ",",
          " ", "Iww"}], "]"}], "\[Rule]", " ", 
       RowBox[{"\[Rho]", " ", "c", " ", 
        RowBox[{"(", 
         RowBox[{"Ds", " ", "+", " ", "Dw", " ", "+", " ", "Dww"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"Is", " ", "+", " ", "Iw", "+", "Iww"}], ")"}]}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sysfunc1", " ", "=", " ", 
    RowBox[{
     RowBox[{"odesRes", "/.", "forceInf"}], "/.", "func1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"sysfunc1", " ", "==", " ", "0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Iww", "->", " ", "0"}], ",", " ", 
      RowBox[{"Iw", "->", " ", "0"}], ",", " ", 
      RowBox[{"Dww", "->", " ", "0"}], ",", " ", 
      RowBox[{"Dw", "->", " ", "0"}], ",", " ", 
      RowBox[{"W", "->", " ", "0"}]}], "}"}]}], ",", " ", "varRes"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.875936294185533*^9, 3.87593631679941*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"a4591b2f-b5d7-4505-b5b7-d8637e1b5b8c"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    20, 2, 30338500834528437662, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.875936323113453*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"e17f2867-f47a-4d54-9d9d-2135d2cee7cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Is", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"d", "-", "r"}], 
        RowBox[{"k", " ", "r"}]]}]}], ",", 
     RowBox[{"Ds", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Is", "\[Rule]", "0"}], ",", 
     RowBox[{"Ds", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Is", "\[Rule]", 
      FractionBox["\[Mu]", 
       RowBox[{"c", " ", "\[Rho]"}]]}], ",", 
     RowBox[{"Ds", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"k", " ", "r", " ", "\[Mu]"}], "+", 
         RowBox[{"c", " ", "d", " ", "\[Rho]"}], "-", 
         RowBox[{"c", " ", "r", " ", "\[Rho]"}]}], 
        RowBox[{"c", " ", 
         SuperscriptBox["\[Rho]", "2"]}]]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8759363231243153`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"abe9db6f-1851-466c-87e7-8a5828502920"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{23, Automatic}, {Automatic, 0}},
Visible->True,
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"43c87cd2-cadb-4edb-adc2-8d7d4ac4403f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 162, 3, 146, "Title",ExpressionUUID->"4f7b14d0-68a4-4e9e-8844-dfc69569ebae"],
Cell[745, 27, 4297, 125, 357, "Input",ExpressionUUID->"69a77141-568c-4912-a97d-032f08a58f23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5079, 157, 172, 3, 146, "Title",ExpressionUUID->"bf247886-d604-4161-b247-a789cee3b752"],
Cell[CellGroupData[{
Cell[5276, 164, 6097, 164, 388, "Input",ExpressionUUID->"8a02a530-1166-4ba7-935f-5e727bc3d247"],
Cell[11376, 330, 306, 6, 52, "Output",ExpressionUUID->"9c6362f6-279d-4afb-ad2c-58f72281db2b"],
Cell[11685, 338, 284, 5, 52, "Output",ExpressionUUID->"d0f4408d-8414-44ac-8f9a-808e892d5f76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12006, 348, 2241, 59, 173, "Input",ExpressionUUID->"9c0cf9f6-65ca-4731-9a3e-4ec1b8dd5c1d"],
Cell[14250, 409, 279, 5, 69, "Output",ExpressionUUID->"11e58714-ddbf-4620-884a-01e5f551fd86"]
}, Open  ]],
Cell[14544, 417, 2061, 56, 140, "Input",ExpressionUUID->"f3b5d819-3c78-4171-9c50-752ee9a63e07"],
Cell[CellGroupData[{
Cell[16630, 477, 615, 15, 46, "Input",ExpressionUUID->"083ecbbc-2a7b-4874-aa34-6a79b9d5ae22"],
Cell[17248, 494, 359, 9, 41, "Message",ExpressionUUID->"5a7ff0a2-d0f2-4682-ae36-fdc555a0a3f3"],
Cell[17610, 505, 617, 18, 72, "Output",ExpressionUUID->"645b1bad-7f5b-4221-bdb8-fdd5ae74ccb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18264, 528, 2833, 76, 233, "Input",ExpressionUUID->"a4591b2f-b5d7-4505-b5b7-d8637e1b5b8c"],
Cell[21100, 606, 359, 9, 41, "Message",ExpressionUUID->"e17f2867-f47a-4d54-9d9d-2135d2cee7cc"],
Cell[21462, 617, 1005, 30, 74, "Output",ExpressionUUID->"abe9db6f-1851-466c-87e7-8a5828502920"]
}, Open  ]]
}, Open  ]]
}
]
*)

